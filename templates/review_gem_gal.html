<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Buildings Evaluation Survey Form</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
    <link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css" />
    <script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>

    <script>
        function handleImageToggle(select, id) {
            const uploadDiv = document.getElementById(id);
            if (select.value === 'Yes' || select.value === 'Corrosion/Spalling') {
                    uploadDiv.style.display = 'block';
                } else {
                    uploadDiv.style.display = 'none';
                }
            }
    </script>

    <style>
        /* Responsive Image Gallery Styles */
        .responsive-gallery {
            display: flex;
            flex-wrap: wrap;
            gap: 15px; /* Space between images */
            justify-content: center; /* Center items in the container */
            padding: 10px 0;
            margin-bottom: 20px; /* Space below the gallery */
        }

        .responsive-gallery a {
            flex: 1 1 200px; /* Grow, shrink, with a base width of 200px */
            max-width: 270px; /* Maximum width an image can take */
            display: block;
            border-radius: 8px;
            overflow: hidden; /* Ensures the image stays within the rounded borders */
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
            text-decoration: none; /* Remove underline from links */
        }

        .responsive-gallery a:hover {
            transform: translateY(-5px) scale(1.03);
            box-shadow: 0 8px 16px rgba(0, 0, 0, 0.2);
        }

        .responsive-gallery img {
            width: 100%;
            height: auto; /* Maintain aspect ratio */
            display: block; /* Remove extra space below image */
            min-height: 150px; /* Minimum height to prevent very short images if aspect ratio is wide */
            object-fit: cover; /* Cover the area, cropping if necessary, good for uniform look */
        }

        /* Style for the heading of the gallery */
        .gallery-title {
            text-align: center;
            margin-top: 20px;
            margin-bottom: 15px;
            font-size: 1.8em;
            color: #333;
        }
    </style>

</head>
<body>

    <div class="container">
        <div class="topnav" id="myTopnav">
          <a href="{{ url_for('index') }}" class="logo">Buildings Evaluation</a>
          <div class="menu-links">
            <a href="{{ url_for('index') }}">Add Listing</a>
            <a href="{{ url_for('admin_dashboard') }}">Review Listings</a>
            <a href="{{ url_for('reviewed_listings') }}">Reviewed Listings</a>
            <a href="#contact">Contact</a>
          </div>
          <a href="javascript:void(0);" class="icon" onclick="toggleMenu()">&#9776;</a>
        </div>
        <br>

        <center><h2>Reviewing Item with ID : <span style="color: brown">{{item_id}}</span></h2></center>
        <strong>1. Location on the Map</strong>
        <div id="map"></div>
        <form action="/submit" method="POST">
        <input type="hidden" name="location" id="location" value="{{ location  }}" required>
            <input type="hidden" name="item_id" id="item_id" value="{{ item_id  }}" required>

            <label for="type_of_use"><strong>2. Select the Type of Use:</strong>
                <span class="tooltip">ℹ️
                    <span class="tooltiptext">This is an explanatory help</span>
                </span>
            </label>
            <select name="type_of_use" id="type_of_use" required>
                {% set options = [
                    "Residential", "Industrial", "Concentrated Audience",
                    "Public Building", "Emergency Building"
                ] %}
                {% for option in options %}
                    <option value="{{ option }}" {% if option == selected_use %}selected{% endif %}>{{ option }}</option>
                {% endfor %}
            </select>

            <label for="number_of_users"><strong>3. Number of Users:</strong>
            <span class="tooltip">ℹ️
                <span class="tooltiptext">This is an explanatory help</span>
            </span></label>
            <select name="number_of_users" id="number_of_users" required>
                {% set options = [
                    "0-10", "11-100", "100+"
                ] %}
                {% for option in options %}
                    <option value="{{ option }}" {% if option == number_of_users %}selected{% endif %}>{{ option }}</option>
                {% endfor %}
            </select>

            <label for="importance_category"><strong>4. Building Importance Category:</strong>
            <span class="tooltip">ℹ️
                <span class="tooltiptext">This is an explanatory help</span>
            </span></label>
            <select name="importance_category" id="importance_category" required>
                {% set options = [
                    "Σ1", "Σ2", "Σ3",
                    "Σ4"
                ] %}
                {% for option in options %}
                    <option value="{{ option }}" {% if option == importance_category %}selected{% endif %}>{{ option }}</option>
                {% endfor %}
            </select>

            <label for="danger_of"><strong>5. Danger of Objects Falling:</strong>
            <span class="tooltip">ℹ️
                <span class="tooltiptext">This is an explanatory help</span>
            </span></label>
            <select name="danger_of" id="danger_of" required onchange="handleImageToggle(this, 'imageUpload')">
                {% set options = [
                    "No", "Yes"
                ] %}
                {% for option in options %}
                    <option value="{{ option }}" {% if option == danger_of %}selected{% endif %}>{{ option }}</option>
                {% endfor %}
            </select>
            <div id="imageUpload" style="display: none; margin-top: 10px;">
                <label for="image">Upload an image:</label>
                <input type="file" name="image" accept="image/*">
            </div>

            <label for="number_of_floors"><strong>6. Number of Floors:</strong>
            <span class="tooltip">ℹ️
                <span class="tooltiptext">This is an explanatory help</span>
            </span></label>
            <input name="number_of_floors" id="number_of_floors" type="number" min="0" max="20" step="1" value="{{ number_of_floors }}" required>

            <label for="condition"><strong>7. Condition of Structure:</strong>
            <span class="tooltip">ℹ️
                <span class="tooltiptext">This is an explanatory help</span>
            </span></label>
            <select name="condition" id="condition" required onchange="handleImageToggle(this, 'imageUpload2')">
                {% set options = [
                    "Good", "Corrosion/Spalling"
                ] %}
                {% for option in options %}
                    <option value="{{ option }}" {% if option == condition %}selected{% endif %}>{{ option }}</option>
                {% endfor %}
            </select>
            <div id="imageUpload2" style="display: none; margin-top: 10px;">
                <label for="image2">Upload an image:</label>
                <input type="file" name="image2" accept="image/*">
            </div>

            <label for="year"><strong>8. Year of Construction:</strong>
            <span class="tooltip">ℹ️
                <span class="tooltiptext">This is an explanatory help</span>
            </span></label>
            <input type="number" id="year" name="year" min="1920" max="2030" step="1" value="{{ year  }}" required>

            <label for="previous_damages"><strong>9. Previous Damages in Vertical Elements:</strong>
            <span class="tooltip">ℹ️
                <span class="tooltiptext">This is an explanatory help</span>
            </span></label>
            <select name="previous_damages" id="previous_damages" required onchange="handleImageToggle(this, 'imageUpload3')">
                {% set options = [
                    "No", "Yes"
                ] %}
                {% for option in options %}
                    <option value="{{ option }}" {% if option == previous_damages %}selected{% endif %}>{{ option }}</option>
                {% endfor %}
            </select>
            <div id="imageUpload3" style="display: none; margin-top: 10px;">
                <label for="image3">Upload an image:</label>
                <input type="file" name="image3" accept="image/*">
            </div>

            <label for="displaycrack"><strong>9a. Maximum Crack Width in mm (Approximately):</strong>
            <span class="tooltip">ℹ️
                <span class="tooltiptext">This is an explanatory help</span>
            </span></label>
            <select name="crack_width" id="crack_width" required>
                {% set options = [
                    "None", "0-1mm", "1-3mm", ">3mm"
                ] %}
                {% for option in options %}
                    <option value="{{ option }}" {% if option == crack_width %}selected{% endif %}>{{ option }}</option>
                {% endfor %}
            </select>

            <label for="danger_neighbour"><strong>10. Contact with Neighbouring Building:</strong>
            <span class="tooltip">ℹ️
                <span class="tooltiptext">This is an explanatory help</span>
            </span></label>
            <select name="danger_neighbour" id="danger_neighbour" required onchange="handleImageToggle(this, 'imageUpload4')">
                {% set options = [
                    "No", "Yes"
                ] %}
                {% for option in options %}
                    <option value="{{ option }}" {% if option == danger_neighbour %}selected{% endif %}>{{ option }}</option>
                {% endfor %}
            </select>
            <div id="imageUpload4" style="display: none; margin-top: 10px;">
                <label for="image4">Upload an image:</label>
                <input type="file" name="image4" accept="image/*">
            </div>

            <label for="soft_floor"><strong>11. Soft Floor (Pilotis):</strong>
            <span class="tooltip">ℹ️
                <span class="tooltiptext">This is an explanatory help</span>
            </span></label>
            <select name="soft_floor" id="soft_floor" required onchange="handleImageToggle(this, 'imageUpload5')">
                {% set options = [
                    "No", "Yes"
                ] %}
                {% for option in options %}
                    <option value="{{ option }}" {% if option == soft_floor %}selected{% endif %}>{{ option }}</option>
                {% endfor %}
            </select>
            <div id="imageUpload5" style="display: none; margin-top: 10px;">
                <label for="image5">Upload an image:</label>
                <input type="file" name="image5" accept="image/*">
            </div>

            <label for="short_column"><strong>12. Short Column:</strong>
            <span class="tooltip">ℹ️
                <span class="tooltiptext"><img src= "{{url_for('static', filename='/Image/short_column.jpg')}}" ></span>
            </span></label>
            <select name="short_column" id="short_column" required onchange="handleImageToggle(this, 'imageUpload6')">
                {% set options = [
                    "No", "Yes"
                ] %}
                {% for option in options %}
                    <option value="{{ option }}" {% if option == short_column %}selected{% endif %}>{{ option }}</option>
                {% endfor %}
            </select>
            <div id="imageUpload6" style="display: none; margin-top: 10px;">
                <label for="image6">Upload an image:</label>
                <input type="file" name="image6" accept="image/*">
            </div>

            <label for="basements"><strong>13. Number of Underground Floors:</strong>
            <span class="tooltip">ℹ️
                <span class="tooltiptext">This is an explanatory help</span>
            </span></label>
            <select name="basements" id="basements" required onchange="handleChoice6(this)">
                {% set options = [
                    "0", "1", "At Least 2"
                ] %}
                {% for option in options %}
                    <option value="{{ option }}" {% if option == basements %}selected{% endif %}>{{ option }}</option>
                {% endfor %}
            </select>

            <h2 class="gallery-title">Image Gallery</h2>
            <div class="responsive-gallery">
                <a href="{{ url_for('static', filename='uploads/{}/image_1.jpg'.format(item_id)) }}" target="_blank">
                    <img src="{{ url_for('static', filename='uploads/{}/image_1.jpg'.format(item_id)) }}" alt="Image 1 for item {{item_id}}" onerror="this.parentElement.style.display='none';">
                </a>
                <a href="{{ url_for('static', filename='uploads/{}/image_2.jpg'.format(item_id)) }}" target="_blank">
                    <img src="{{ url_for('static', filename='uploads/{}/image_2.jpg'.format(item_id)) }}" alt="Image 2 for item {{item_id}}" onerror="this.parentElement.style.display='none';">
                </a>
                <a href="{{ url_for('static', filename='uploads/{}/image_3.jpg'.format(item_id)) }}" target="_blank">
                    <img src="{{ url_for('static', filename='uploads/{}/image_3.jpg'.format(item_id)) }}" alt="Image 3 for item {{item_id}}" onerror="this.parentElement.style.display='none';">
                </a>
                <a href="{{ url_for('static', filename='uploads/{}/image_4.jpg'.format(item_id)) }}" target="_blank">
                    <img src="{{ url_for('static', filename='uploads/{}/image_4.jpg'.format(item_id)) }}" alt="Image 4 for item {{item_id}}" onerror="this.parentElement.style.display='none';">
                </a>
                <a href="{{ url_for('static', filename='uploads/{}/image_5.jpg'.format(item_id)) }}" target="_blank">
                    <img src="{{ url_for('static', filename='uploads/{}/image_5.jpg'.format(item_id)) }}" alt="Image 5 for item {{item_id}}" onerror="this.parentElement.style.display='none';">
                </a>
                <a href="{{ url_for('static', filename='uploads/{}/image_6.jpg'.format(item_id)) }}" target="_blank">
                    <img src="{{ url_for('static', filename='uploads/{}/image_6.jpg'.format(item_id)) }}" alt="Image 6 for item {{item_id}}" onerror="this.parentElement.style.display='none';">
                </a>
                <a href="{{ url_for('static', filename='uploads/{}/image_7.jpg'.format(item_id)) }}" target="_blank">
                    <img src="{{ url_for('static', filename='uploads/{}/image_7.jpg'.format(item_id)) }}" alt="Image 7 for item {{item_id}}" onerror="this.parentElement.style.display='none';">
                </a>
                <a href="{{ url_for('static', filename='uploads/{}/image_8.jpg'.format(item_id)) }}" target="_blank">
                    <img src="{{ url_for('static', filename='uploads/{}/image_8.jpg'.format(item_id)) }}" alt="Image 8 for item {{item_id}}" onerror="this.parentElement.style.display='none';">
                </a>
            </div>
            <center><h2>Reviewers Form for Item with ID : <span style="color: green">{{item_id}}</span></h2></center><br>

            <label for="type_of_struct"><strong>1. Type of Structural System:</strong>
            <span class="tooltip">ℹ️
                <span class="tooltiptext">This is an explanatory help</span>
            </span></label>
            <select name="type_of_struct" id="type_of_struct" required>
                <option value="RC-frames">RC-frames</option>
                <option value="RC-walls">RC-walls</option>
                <option value="Brick walls">Brick walls</option>
            </select>

            <label for="arrangement"><strong>2. Arrangement of Walls</strong>
            <span class="tooltip">ℹ️
                <span class="tooltiptext">This is an explanatory help</span>
            </span></label>
            <select name="arrangement" id="arrangement" required>
                <option value="Regular">Regular</option>
                <option value="Irregular">Irregular</option>
            </select>

            <label for="irregular_vert"><strong>3. Irregular Structures Vertically</strong>
            <span class="tooltip">ℹ️
                <span class="tooltiptext">This is an explanatory help</span>
            </span></label>
            <select name="irregular_vert" id="irregular_vert" required>
                <option value="No">No</option>
                <option value="Yes">Yes</option>
            </select>

            <label for="irregular_hor"><strong>4. Irregular Structures Horizontally</strong>
            <span class="tooltip">ℹ️
                <span class="tooltiptext">This is an explanatory help</span>
            </span></label>
            <select name="irregular_hor" id="irregular_hor" required>
                <option value="No">No</option>
                <option value="Yes">Yes</option>
            </select>

            <label for="torsion"><strong>5. Torsion/Rotation</strong>
            <span class="tooltip">ℹ️
                <span class="tooltiptext">This is an explanatory help</span>
            </span></label>
            <select name="torsion" id="torsion" required>
                <option value="No">No</option>
                <option value="Yes">Yes</option>
            </select>

            <label for="vulnerabilities"><strong>6. Structural Vulnerabilities</strong>
            <span class="tooltip">ℹ️
                <span class="tooltiptext">This is an explanatory help</span>
            </span></label>
            <select name="vulnerabilities" id="vulnerabilities" required multiple>
                <option value="None" selected>None</option>
                <option value="Danger of impact">Danger of impact</option>
                <option value="Soft floor">Soft floor</option>
                <option value="Short column">Short column</option>
            </select>

            <label for="heavy_finishes"><strong>7. Heavy Finishes</strong>
            <span class="tooltip">ℹ️
                <span class="tooltiptext">This is an explanatory help</span>
            </span></label>
            <select name="heavy_finishes" id="heavy_finishes" required>
                <option value="No">No</option>
                <option value="Yes">Yes</option>
            </select>

            <label for="user_quality"><strong>8. Quality of User Input (1-5)</strong>
            <span class="tooltip">ℹ️
                <span class="tooltiptext">This is an explanatory help</span>
            </span></label>
            <input type="range" min="1" max="5" type="number" value="1" id="user_quality" name="user_quality">

            <label for="soil_class"><strong>9. Soil Class</strong>
            <span class="tooltip">ℹ️
                <span class="tooltiptext">This is an explanatory help</span>
            </span></label>
            <select name="soil_class" id="soil_class" required>
                <option value="A">A</option>
                <option value="B">B</option>
                <option value="C">C</option>
            </select>

            <label for="bearing_capacity"><strong>10. Load Bearing Capacity Reduction (R)</strong>
            <span class="tooltip">ℹ️
                <span class="tooltiptext">This is an explanatory help</span>
            </span></label>
            <select name="bearing_capacity" id="bearing_capacity" required>
                <option value="None">None</option>
                <option value="Flexural cracks">Flexural cracks</option>
                <option value="Multiple flexural cracks">Multiple flexural cracks</option>
                <option value="Diagonal cracks">Diagonal cracks</option>
                <option value="Bending reinforcement">Bending reinforcement</option>
            </select>

            <label for="total_area"><strong>11. Total Constructed Area</strong>
            <span class="tooltip">ℹ️
                <span class="tooltiptext">This is an explanatory help</span>
            </span></label>
            <input type="number" id="total_area" name="total_area" min="0" max="5000" step="1" value="0" required>

            <label for="retrofitting"><strong>12. Retrofitting Methods</strong>
            <span class="tooltip">ℹ️
                <span class="tooltiptext">This is an explanatory help</span>
            </span></label>
            <select name="retrofitting" id="retrofitting" required>
                <option value="Retrofitting RC-nodes">Retrofitting RC-nodes</option>
                <option value="Retrofitting RC-beams">Retrofitting RC-beams</option>
                <option value="Polyurethane joints">Polyurethane joints</option>
                <option value="FRPU jackets">FRPU jackets</option>
            </select>


            <button type="submit">Submit</button>
        </form>
    </div>

    <script>
        var lat = {{ lat }};
        var lon = {{ lon }};

        var map = L.map('map').setView([lat, lon], 13);
        L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
            attribution: '&copy; OpenStreetMap contributors'
        }).addTo(map);

        L.marker([lat, lon]).addTo(map)
            .bindPopup('Selected Location')
            .openPopup();
    </script>

    <script>
      function toggleMenu() {
        document.getElementById("myTopnav").classList.toggle("responsive");
      }
    </script>

</body>
</html>